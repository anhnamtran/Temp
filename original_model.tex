\newcommand{\code}[1]{\texttt{#1}}

\subsection{Overview}
This model uses prioritized ordering between values of expressions. It tells the
cost model which value it cares about the most. From first to last, the cost
model will compare the asymptotic runtimes, the max storage sizes, the true
runtimes, and the true sizes of two expressions.

Because of the prioritized ordering, values lower in the prioritized list will
only be calculated to break ties from the more important ones.

\subsection{Improvements}
There are special heuristics that Cozy follows to prevent unwanted behaviors,
one of which is having integer arithmetic stored as a state variable. Once this
heuristic is removed, Cozy will start producing unwanted state variables.
Specifically, when provided with this specification and no heuristic:

\begin{center}
\begin{lstlisting}
    Incrementer:
        state x : Int
        query get()
            x
        op increment()
            x = x + 1;
\end{lstlisting}
\end{center}

Cozy will continuously store each increment of \code{x} as state variables. As
Cozy runs for longer and longer, the stored states will go from \code{(x + 1)},
to \code{((x + 1) + 1)}, to \code{(((x + 1) + 1) +1)}, and so forth.

When the heuristic is not in place, the cost model will tell Cozythat storing
each increment of \code{x} as a state is better than just storing \code{x}
itself. To prevent this behavior and remove the necessity of the heuristic, we
introduced freebies to the cost model. Freebies are state variables that will
have no cost. With them in place, Cozy will chose to store just \code{x} instead
of its increments as states.

\subsection{Challenge and Solution}
The challenge, then, is how to choose which state variables to become freebies.
One option is to just use state variables that are also hints taken from values
of the concretization functions. However, since the hints contain states
generated by every query, they introduce a problem: Cozy might change its mind
on a query and decide to remove it, in which case the states associated with it
would be removed as well. This will leave states that Cozy does not use, but the
cost model still considers to be free.

So instead of using hints, the freebies are chosen from a list of state
variables that are maintained by the query currently being improved. By choosing
the freebies this way, we make sure that the state varable is only free for
subqueries derived from the current query and not for any other queries.
